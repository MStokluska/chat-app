(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(n,t,e){n.exports=e(170)},123:function(n,t,e){},170:function(n,t,e){"use strict";e.r(t);var a=e(109),r=e(208),c=e(0),i=e.n(c),o=e(15),u=e.n(o),l=e(44),s=(e(123),e(35)),d=e(37),f=e(2),b=e(6),m=e(78);function p(){var n=Object(f.a)(["\n  position: relative;\n  overflow: hidden;\n  height: 100vh;\n  width: 100vw;\n\n  > div {\n    position: absolute;\n    overflow: hidden;\n    height: 100vh;\n    width: 100vw;\n  }\n"]);return p=function(){return n},n}var h=m.a,v=function(n){return Object(m.b)(n,{stiffness:174,damping:24})},g=function(n){return{transform:"translateX(".concat(n.offset,"%)")}},j=Object(b.b)(h).attrs(function(){return{atEnter:{offset:100},atLeave:{offset:v(-100)},atActive:{offset:v(0)},mapStyles:g}})(p()),O=e(16),x=e(13),y=e.n(x),E=e(198),w=e(207),C=e(199);function k(){var n=Object(f.a)(["\n  mutation signUp(\n    $name: String!\n    $username: String!\n    $password: String!\n    $passwordConfirm: String!\n  ) {\n    signUp(\n      name: $name\n      username: $username\n      password: $password\n      passwordConfirm: $passwordConfirm\n    ) {\n      id\n    }\n  }\n"]);return k=function(){return n},n}function M(){var n=Object(f.a)(["\n  mutation signIn($username: String!, $password: String!) {\n    signIn(username: $username, password: $password) {\n      id\n    }\n  }\n"]);return M=function(){return n},n}function I(){var n=Object(f.a)(["\n  subscription MessageAdded {\n    messageAdded {\n      ...Message\n    }\n  }\n  ","\n"]);return I=function(){return n},n}function $(){var n=Object(f.a)(["\n  subscription ChatRemoved {\n    chatRemoved\n  }\n"]);return $=function(){return n},n}function S(){var n=Object(f.a)(["\n  subscription ChatAdded {\n    chatAdded {\n      ...Chat\n    }\n  }\n  ","\n"]);return S=function(){return n},n}function A(){var n=Object(f.a)(["\n  query Me {\n    me {\n      ...User\n    }\n  }\n  ","\n"]);return A=function(){return n},n}function q(){var n=Object(f.a)(["\n  query Chats {\n    chats {\n      ...Chat\n    }\n  }\n  ","\n"]);return q=function(){return n},n}function D(){var n=Object(f.a)(["\n  query UsersList {\n    users {\n      ...User\n    }\n  }\n  ","\n"]);return D=function(){return n},n}function F(){var n=Object(f.a)(["\n  mutation AddMessage($chatId: ID!, $content: String!) {\n    addMessage(chatId: $chatId, content: $content) {\n      ...Message\n    }\n  }\n  ","\n"]);return F=function(){return n},n}function R(){var n=Object(f.a)(["\n  query GetChat($chatId: ID!, $limit: Int!, $after: Float) {\n    chat(chatId: $chatId) {\n      ...FullChat\n    }\n  }\n  ","\n"]);return R=function(){return n},n}function U(){var n=Object(f.a)(["\n  mutation RemoveChat($chatId: ID!) {\n    removeChat(chatId: $chatId)\n  }\n"]);return U=function(){return n},n}function _(){var n=Object(f.a)(["\n  mutation AddChat($recipientId: ID!) {\n    addChat(recipientId: $recipientId) {\n      ...Chat\n    }\n  }\n  ","\n"]);return _=function(){return n},n}function z(){var n=Object(f.a)(["\n  fragment User on User {\n    id\n    name\n    picture\n  }\n"]);return z=function(){return n},n}function N(){var n=Object(f.a)(['\n  fragment FullChat on Chat {\n    ...Chat\n    messages(limit: $limit, after: $after) @connection(key: "messages") {\n      ...MessagesResult\n    }\n  }\n  ',"\n  ","\n"]);return N=function(){return n},n}function L(){var n=Object(f.a)(["\n  fragment MessagesResult on MessagesResult {\n    cursor\n    hasMore\n    messages {\n      ...Message\n    }\n  }\n  ","\n"]);return L=function(){return n},n}function P(){var n=Object(f.a)(["\n  fragment Chat on Chat {\n    id\n    name\n    picture\n    lastMessage {\n      ...Message\n    }\n  }\n  ","\n"]);return P=function(){return n},n}function H(){var n=Object(f.a)(["\n  fragment Message on Message {\n    id\n    createdAt\n    content\n    isMine\n    chat {\n      id\n    }\n  }\n"]);return H=function(){return n},n}var Q=y()(H()),T=y()(P(),Q),W=y()(L(),Q),B=y()(N(),T,W),G=y()(z()),J=y()(_(),T);var K=y()(U());var X=y()(R(),B);var V=y()(F(),Q);var Y=y()(D(),G);var Z=y()(q(),T);var nn=y()(A(),G);var tn=y()(S(),T);var en=y()($());var an=y()(I(),Q);var rn=y()(M());var cn=y()(k());var on=e(51);function un(){var n=Object(f.a)(["\n  fragment Message on Message {\n    id\n    createdAt\n    content\n    isMine\n    chat {\n      id\n    }\n  }\n"]);return un=function(){return n},n}var ln=y()(un());function sn(){var n=Object(f.a)(["\n  fragment Chat on Chat {\n    id\n    name\n    picture\n    lastMessage {\n      ...Message\n    }\n  }\n  ","\n"]);return sn=function(){return n},n}var dn=y()(sn(),ln);function fn(){var n=Object(f.a)(["\n  fragment MessagesResult on MessagesResult {\n    cursor\n    hasMore\n    messages {\n      ...Message\n    }\n  }\n  ","\n"]);return fn=function(){return n},n}var bn=y()(fn(),ln);function mn(){var n=Object(f.a)(['\n  fragment FullChat on Chat {\n    ...Chat\n    messages(limit: $limit, after: $after) @connection(key: "messages") {\n      ...MessagesResult\n    }\n  }\n  ',"\n  ","\n"]);return mn=function(){return n},n}var pn=y()(mn(),dn,bn);function hn(){var n=Object(f.a)(["\n  fragment User on User {\n    id\n    name\n    picture\n  }\n"]);return hn=function(){return n},n}var vn=y()(hn());function gn(){var n=Object(f.a)(["\n  query Chats {\n    chats {\n      ...Chat\n    }\n  }\n  ","\n"]);return gn=function(){return n},n}var jn=y()(gn(),dn),On=function(){var n;n={onSubscriptionData:function(n){var t=n.client,e=n.subscriptionData.data;e&&xn(t,e.messageAdded)}},C.a(an,n),function(n){C.a(tn,n)}({onSubscriptionData:function(n){var t=n.client,e=n.subscriptionData.data;e&&yn(t,e.chatAdded)}}),function(n){C.a(en,n)}({onSubscriptionData:function(n){var t=n.client,e=n.subscriptionData.data;e&&En(t,e.chatRemoved)}})},xn=function(n,t){var e,a=Object(on.b)(t.chat);if(null!==a){try{e=n.readFragment({id:a,fragment:pn,fragmentName:"FullChat"})}catch(u){return}if(null!==e&&null!==e.messages&&!e.messages.messages.some(function(n){return n.id===t.id})){var r;e.messages.messages.push(t),e.lastMessage=t,n.writeFragment({id:a,fragment:pn,fragmentName:"FullChat",data:e});try{r=n.readQuery({query:jn})}catch(u){return}if(!r||null===r)return null;if(!r.chats||void 0===r.chats)return null;var c=r.chats,i=c.findIndex(function(n){return null===t||null===t.chat?-1:n.id===t.chat.id});if(-1!==i){var o=c[i];c.splice(i,1),c.unshift(o),n.writeQuery({query:jn,data:{chats:c}})}}}},yn=function(n,t){var e=Object(on.b)(t);if(null!==e){var a;n.writeFragment({id:e,fragment:dn,fragmentName:"Chat",data:t});try{a=n.readQuery({query:jn})}catch(c){return}if(a){var r=a.chats;r&&(r.some(function(n){return n.id===t.id})||(r.unshift(t),n.writeQuery({query:jn,data:{chats:r}})))}}},En=function(n,t){var e={__typename:"Chat",id:t},a=Object(on.b)(e);if(null!==a){var r;n.writeFragment({id:a,fragment:pn,fragmentName:"FullChat",data:null});try{r=n.readQuery({query:jn})}catch(o){return}if(r&&r.chats){var c=r.chats;if(c){var i=c.findIndex(function(n){return n.id===t});-1!==i&&(c.splice(i,1),n.writeQuery({query:jn,data:{chats:c}}))}}}},wn=i.a.createContext(null),Cn=function(n){return function(t){if(!$n())return"/sign-in"===t.history.location.pathname?null:i.a.createElement(d.a,{to:"/sign-in"});var e,a=In(),r=w.a(nn,e),c=r.data,o=r.error,u=r.loading;return On(),u?null:void 0===c?null:o||!c.me?(a(),i.a.createElement(d.a,{to:"/sign-in"})):i.a.createElement(wn.Provider,{value:c.me},i.a.createElement(n,t))}},kn=function(n){return E.a(rn,n)},Mn=function(n){return E.a(cn,n)},In=function(){var n=Object(l.b)();return Object(c.useCallback)(function(){return document.cookie="authToken=;expires=".concat(new Date(0)),n.clearStore()},[n])},$n=function(){return/authToken=.+(;|$)/.test(document.cookie)},Sn=e(203),An=e(206);function qn(){var n=Object(f.a)(["\n  position: fixed;\n  color: red;\n  font-size: 15px;\n  margin-top: 20px;\n"]);return qn=function(){return n},n}function Dn(){var n=Object(f.a)(["\n  width: 100px;\n  display: block !important;\n  margin: auto !important;\n  background-color: var(--secondary-bg) !important;\n\n  &[disabled] {\n    color: #38a81c;\n  }\n\n  &:not([disabled]) {\n    color: white;\n  }\n"]);return Dn=function(){return n},n}function Fn(){var n=Object(f.a)(["\n  width: 100%;\n  position: relative;\n\n  > div::before {\n    border-color: white !important;\n  }\n\n  input {\n    color: white !important;\n\n    &::placeholder {\n      color: var(--primary-bg) !important;\n    }\n  }\n\n  label {\n    color: white !important;\n  }\n"]);return Fn=function(){return n},n}function Rn(){var n=Object(f.a)(["\n  color: white;\n\n  &::placeholder {\n    color: var(--primary-bg);\n  }\n"]);return Rn=function(){return n},n}function Un(){var n=Object(f.a)(["\n  color: white !important;\n"]);return Un=function(){return n},n}function _n(){var n=Object(f.a)(["\n  font-weight: bold;\n  color: white;\n"]);return _n=function(){return n},n}function zn(){var n=Object(f.a)(["\n  padding-bottom: 35px;\n"]);return zn=function(){return n},n}function Nn(){var n=Object(f.a)(["\n  padding: 20px;\n"]);return Nn=function(){return n},n}function Ln(){var n=Object(f.a)(["\n  height: calc(100% - 265px);\n"]);return Ln=function(){return n},n}var Pn=b.b.div(Ln()),Hn=b.b.form(Nn()),Qn=b.b.div(zn()),Tn=b.b.legend(_n()),Wn=(b.b.label(Un()),b.b.input(Rn()),Object(b.b)(An.a)(Fn())),Bn=Object(b.b)(Sn.a)(Dn()),Gn=b.b.div(qn()),Jn=function(n){var t=n.history,e=Object(c.useState)(""),a=Object(O.a)(e,2),r=a[0],o=a[1],u=Object(c.useState)(""),l=Object(O.a)(u,2),s=l[0],d=l[1],f=Object(c.useState)(""),b=Object(O.a)(f,2),m=b[0],p=b[1],h=kn(),v=Object(O.a)(h,1)[0],g=Object(c.useCallback)(function(n){var t=n.target;p(""),o(t.value)},[]),j=Object(c.useCallback)(function(n){var t=n.target;p(""),d(t.value)},[]),x=Object(c.useCallback)(function(){return!(!r||!s)},[r,s]),y=Object(c.useCallback)(function(){v({variables:{username:r,password:s}}).then(function(){t.replace("/chats")}).catch(function(n){p(n.message||n)})},[r,s,t,v]);return i.a.createElement(Pn,null,i.a.createElement(Hn,null,i.a.createElement(Tn,null,"Sign in"),i.a.createElement(Qn,{style:{width:"100%"}},i.a.createElement(Wn,{"data-testid":"username-input",label:"Username",value:r,onChange:g,margin:"normal",placeholder:"Enter your username"}),i.a.createElement(Wn,{"data-testid":"password-input",label:"Password",type:"password",value:s,onChange:j,margin:"normal",placeholder:"Enter your password"})),i.a.createElement(Bn,{"data-testid":"sign-in-button",type:"button",color:"secondary",variant:"contained",disabled:!x(),onClick:y},"Sign in"),i.a.createElement(Gn,{"data-testid":"error-message"},m)))},Kn=function(n){var t=n.history,e=Object(c.useState)(""),a=Object(O.a)(e,2),r=a[0],o=a[1],u=Object(c.useState)(""),l=Object(O.a)(u,2),s=l[0],d=l[1],f=Object(c.useState)(""),b=Object(O.a)(f,2),m=b[0],p=b[1],h=Object(c.useState)(""),v=Object(O.a)(h,2),g=v[0],j=v[1],x=Object(c.useState)(""),y=Object(O.a)(x,2),E=y[0],w=y[1],C=Mn(),k=Object(O.a)(C,1)[0],M=Object(c.useCallback)(function(n){var t=n.target;w(""),o(t.value)},[]),I=Object(c.useCallback)(function(n){var t=n.target;w(""),d(t.value)},[]),$=Object(c.useCallback)(function(n){var t=n.target;w(""),p(t.value)},[]),S=Object(c.useCallback)(function(n){var t=n.target;w(""),j(t.value)},[]),A=Object(c.useCallback)(function(){return!!(r&&s&&m&&m===g)},[r,s,m,g]),q=Object(c.useCallback)(function(){k({variables:{username:s,password:m,passwordConfirm:g,name:r}}).then(function(){t.replace("/sign-in")}).catch(function(n){w(n.message||n)})},[r,s,m,g,t,k]);return i.a.createElement(Pn,null,i.a.createElement(Hn,null,i.a.createElement(Tn,null,"Sign up"),i.a.createElement(Qn,{style:{float:"left",width:"calc(50% - 10px)",paddingRight:"10px"}},i.a.createElement(Wn,{"data-testid":"name-input",label:"Name",value:r,onChange:M,autoComplete:"off",margin:"normal"}),i.a.createElement(Wn,{"data-testid":"username-input",label:"Username",value:s,onChange:I,autoComplete:"off",margin:"normal"})),i.a.createElement(Qn,{style:{float:"right",width:"calc(50% - 10px)",paddingLeft:"10px"}},i.a.createElement(Wn,{"data-testid":"password-input",label:"Password",type:"password",value:m,onChange:$,autoComplete:"off",margin:"normal"}),i.a.createElement(Wn,{"data-testid":"password-confirm-input",label:"Confirm password",type:"password",value:g,onChange:S,autoComplete:"off",margin:"normal"})),i.a.createElement(Bn,{"data-testid":"sign-up-button",type:"button",color:"secondary",variant:"contained",disabled:!A(),onClick:q},"Sign up"),i.a.createElement(Gn,{"data-testid":"error-message"},E)))};function Xn(){var n=Object(f.a)(["\n  position: fixed;\n  bottom: 10px;\n  left: 10px;\n\n  label {\n    color: var(--secondary-bg);\n  }\n"]);return Xn=function(){return n},n}function Vn(){var n=Object(f.a)(["\n  width: 100%;\n  text-align: center;\n  color: white;\n"]);return Vn=function(){return n},n}function Yn(){var n=Object(f.a)(["\n  width: 125px;\n  height: auto;\n  margin-left: auto;\n  margin-right: auto;\n  padding-top: 70px;\n  display: block;\n"]);return Yn=function(){return n},n}function Zn(){var n=Object(f.a)(["\n  height: 265px;\n"]);return Zn=function(){return n},n}function nt(){var n=Object(f.a)(["\n  background: radial-gradient(rgb(34, 65, 67), rgb(17, 48, 50)),\n    url(/assets/chat-background.jpg) no-repeat;\n  background-size: cover;\n  background-blend-mode: multiply;\n  color: white;\n"]);return nt=function(){return n},n}var tt=b.b.div(nt()),et=b.b.div(Zn()),at=b.b.img(Yn()),rt=b.b.h2(Vn()),ct=b.b.div(Xn()),it=function(n){var t=n.history,e=n.location,a=Object(c.useMemo)(function(){return"/sign-in"===e.pathname?i.a.createElement(ct,null,"Don't have an account yet?"," ",i.a.createElement("label",{onClick:function(){t.replace("/sign-up")}},"Sign up!")):i.a.createElement(ct,null,"Already have an accout? ",i.a.createElement("label",{onClick:function(){t.replace("/sign-in")}},"Sign in!"))},[e.pathname,t]);return i.a.createElement(tt,{className:"AuthScreen Screen"},i.a.createElement(et,{className:"AuthScreen-intro"},i.a.createElement(at,{src:"assets/whatsapp-icon.png",className:"AuthScreen-icon"}),i.a.createElement(rt,{className:"AuthScreen-title"},"WhatsApp")),i.a.createElement(j,null,i.a.createElement(d.b,{exact:!0,path:"/sign-in",component:Jn}),i.a.createElement(d.b,{exact:!0,path:"/sign-up",component:Kn})),a)},ot=e(69),ut=e(79),lt=e(204),st=e(66),dt=e.n(st),ft=e(104),bt=e.n(ft);function mt(){var n=Object(f.a)(["\n  mutation RemoveChat($chatId: ID!) {\n    removeChat(chatId: $chatId)\n  }\n"]);return mt=function(){return n},n}function pt(){var n=Object(f.a)(["\n  color: var(--primary-text) !important;\n"]);return pt=function(){return n},n}function ht(){var n=Object(f.a)(["\n  line-height: 56px;\n"]);return ht=function(){return n},n}function vt(){var n=Object(f.a)(["\n  height: 40px;\n  width: 40px;\n  margin-top: 3px;\n  margin-left: -22px;\n  object-fit: cover;\n  padding: 5px;\n  border-radius: 50%;\n"]);return vt=function(){return n},n}function gt(){var n=Object(f.a)(["\n  flex: 1;\n  display: flex;\n  justify-content: flex-end;\n"]);return gt=function(){return n},n}function jt(){var n=Object(f.a)(["\n  svg {\n    color: var(--primary-text);\n  }\n"]);return jt=function(){return n},n}function Ot(){var n=Object(f.a)(["\n  padding: 0;\n  display: flex;\n  flex-direction: row;\n  background-color: var(--primary-bg);\n  color: var(--primary-text);\n"]);return Ot=function(){return n},n}var xt=Object(b.b)(lt.a)(Ot()),yt=Object(b.b)(Sn.a)(jt()),Et=b.b.div(gt()),wt=b.b.img(vt()),Ct=b.b.div(ht()),kt=Object(b.b)(Sn.a)(pt()),Mt=(y()(mt()),function(n){var t,e=n.chat,a=n.history,r=(t={variables:{chatId:e.id},update:function(n,t){var e=t.data.removeChat;En(n,e)}},E.a(K,t)),o=Object(O.a)(r,1)[0],u=Object(c.useCallback)(function(){o().then(function(){a.replace("/chats")})},[o,a]),l=Object(c.useCallback)(function(){a.replace("/chats")},[a]);return i.a.createElement(xt,null,i.a.createElement(yt,{"data-testid":"back-button",onClick:l},i.a.createElement(dt.a,null)),e&&e.picture&&e.name&&i.a.createElement(i.a.Fragment,null,i.a.createElement(wt,{"data-testid":"chat-picture",src:e.picture}),i.a.createElement(Ct,{"data-testid":"chat-name"},e.name)),i.a.createElement(Et,null,i.a.createElement(kt,{"data-testid":"delete-button",onClick:u},i.a.createElement(bt.a,null))))}),It=e(105),$t=e.n(It);function St(){var n=Object(f.a)(["\n  min-width: 50px !important;\n  width: 50px !important;\n  border-radius: 999px !important;\n  background-color: var(--primary-bg) !important;\n  margin: 0 5px !important;\n  margin-right: 0 !important;\n  color: white !important;\n  padding-left: 20px !important;\n\n  svg {\n    margin-left: -3px;\n  }\n"]);return St=function(){return n},n}function At(){var n=Object(f.a)(["\n  width: calc(100% - 50px);\n  border: none;\n  border-radius: 999px;\n  padding: 10px;\n  padding-left: 20px;\n  padding-right: 20px;\n  font-size: 15px;\n  outline: none;\n  box-shadow: 0 1px silver;\n  font-size: 18px;\n  line-height: 45px;\n"]);return At=function(){return n},n}function qt(){var n=Object(f.a)(["\n  display: flex;\n  height: 50px;\n  padding: 5px;\n  width: calc(100% - 10px);\n"]);return qt=function(){return n},n}var Dt=b.b.div(qt()),Ft=b.b.input(At()),Rt=Object(b.b)(Sn.a)(St()),Ut=function(n){var t=n.onSendMessage,e=Object(c.useState)(""),a=Object(O.a)(e,2),r=a[0],o=a[1],u=function(){r&&(o(""),"function"===typeof t&&t(r))};return i.a.createElement(Dt,null,i.a.createElement(Ft,{"data-testid":"message-input",type:"text",placeholder:"Type a message",value:r,onKeyPress:function(n){13===n.charCode&&u()},onChange:function(n){var t=n.target;o(t.value)}}),i.a.createElement(Rt,{"data-testid":"send-button",variant:"contained",color:"primary",onClick:u},i.a.createElement($t.a,null)))},_t=e(67),zt=e.n(_t),Nt=function(n){var t=n.ref,e=n.hasMore,a=n.onLoadMore,r=Object(c.useState)(!1),i=Object(O.a)(r,2),o=i[0],u=i[1],l=Object(c.useCallback)(function(){0===t.current.scrollTop&&!1===o&&e&&u(!0)},[t,o,e]);Object(c.useEffect)(function(){var n=t.current;if(n)return n.addEventListener("scroll",l),function(){n.removeEventListener("scroll",l)}},[t,l]),Object(c.useEffect)(function(){o&&a()},[o,a]);var s=Object(c.useCallback)(function(){u(!1)},[]);return[o,s]};function Lt(){var n=Object(f.a)(["\n  position: absolute;\n  bottom: 2px;\n  right: 7px;\n  color: gray;\n  font-size: 12px;\n"]);return Lt=function(){return n},n}function Pt(){var n=Object(f.a)(["\n  padding: 5px 7px;\n  word-wrap: break-word;\n\n  &::after {\n    content: ' \\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0\\00a0';\n    display: inline;\n  }\n"],["\n  padding: 5px 7px;\n  word-wrap: break-word;\n\n  &::after {\n    content: ' \\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0\\\\00a0';\n    display: inline;\n  }\n"]);return Pt=function(){return n},n}function Ht(){var n=Object(f.a)(["\n          float: left;\n          background-color: #fff;\n\n          &::before {\n            left: -11px;\n            background-image: url(/assets/message-other.png);\n          }\n        "]);return Ht=function(){return n},n}function Qt(){var n=Object(f.a)(["\n          float: right;\n          background-color: #dcf8c6;\n\n          &::before {\n            right: -11px;\n            background-image: url(/assets/message-mine.png);\n          }\n        "]);return Qt=function(){return n},n}function Tt(){var n=Object(f.a)(["\n  display: inline-block;\n  position: relative;\n  max-width: 100%;\n  border-radius: 7px;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);\n  margin-top: 10px;\n  margin-bottom: 10px;\n  clear: both;\n\n  &::after {\n    content: '';\n    display: table;\n    clear: both;\n  }\n\n  &::before {\n    content: '';\n    position: absolute;\n    bottom: 3px;\n    width: 12px;\n    height: 19px;\n    background-position: 50% 50%;\n    background-repeat: no-repeat;\n    background-size: contain;\n  }\n\n  ","\n"]);return Tt=function(){return n},n}function Wt(){var n=Object(f.a)(["\n  height: 30px;\n  line-height: 30px;\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  text-align: center;\n"]);return Wt=function(){return n},n}function Bt(){var n=Object(f.a)(["\n  position: relative;\n  display: block;\n  flex: 2;\n  overflow-y: overlay;\n  padding: 0 15px;\n"]);return Bt=function(){return n},n}var Gt=b.b.div(Bt()),Jt=b.b.div(Wt()),Kt=b.b.div(Tt(),function(n){return n.isMine?Object(b.a)(Qt()):Object(b.a)(Ht())}),Xt=b.b.div(Pt()),Vt=b.b.div(Lt()),Yt=function(n){var t=n.messages,e=n.loadMore,a=n.hasMore,r=Object(c.useRef)(null),u=Nt({onLoadMore:e,hasMore:a,ref:r}),l=Object(O.a)(u,2),s=l[0],d=l[1],f=function(n){var t=Object(c.useState)(),e=Object(O.a)(t,2),a=e[0],r=e[1];return Object(c.useCallback)(function(t){if(n.current){var e=o.findDOMNode(n.current),c=!t&&a?a.height:e.clientHeight;e.scrollTop=e.scrollHeight-c,r({top:e.scrollTop,height:e.scrollHeight})}},[n,a])}(r);return Object(c.useEffect)(function(){r.current&&(s?(d(),f()):f(!0))},[t.length,r,s,d,f]),i.a.createElement(Gt,{ref:r},s&&i.a.createElement(Jt,null,"Loading more messages..."),t.map(function(n){return i.a.createElement(Kt,{"data-testid":"message-item",isMine:n.isMine,key:n.id},i.a.createElement(Xt,{"data-testid":"message-content"},n.content),i.a.createElement(Vt,{"data-testid":"message-date"},zt()(n.createdAt,"HH:mm")))}))};function Zt(){var n=Object(f.a)(["\n  mutation AddMessage($chatId: ID!, $content: String!) {\n    addMessage(chatId: $chatId, content: $content) {\n      ...Message\n    }\n  }\n  ","\n"]);return Zt=function(){return n},n}function ne(){var n=Object(f.a)(["\n  query GetChat($chatId: ID!, $limit: Int!, $after: Float) {\n    chat(chatId: $chatId) {\n      ...FullChat\n    }\n  }\n  ","\n"]);return ne=function(){return n},n}function te(){var n=Object(f.a)(["\n  background: url(/assets/chat-background.jpg);\n  display: flex;\n  flex-flow: column;\n  height: 100vh;\n"]);return te=function(){return n},n}var ee=b.b.div(te()),ae=(y()(ne(),pn),y()(Zt(),ln),i.a.createContext({after:0,limit:20,setAfter:function(n){},reset:function(){}})),re=function(){var n=Object(c.useContext)(ae);return Object(c.useEffect)(function(){return function(){n.reset()}},[n]),n},ce=function(n){var t=n.children,e=Object(c.useState)(null),a=Object(O.a)(e,2),r=a[0],o=a[1];return i.a.createElement(ae.Provider,{value:{limit:20,after:r,setAfter:o,reset:function(){return o(null)}}},t)},ie=function(n){var t,e=n.history,a=n.chatId,r=re(),o=r.after,u=r.limit,l=r.setAfter,s=(t={variables:{chatId:a,after:o,limit:u}},w.a(X,t)),f=s.data,b=s.loading,m=s.fetchMore,p=function(n){return E.a(V,n)}(),h=Object(O.a)(p,1)[0],v=Object(c.useCallback)(function(n){return void 0===f?null:null===f.chat?null:void h({variables:{chatId:a,content:n},optimisticResponse:{__typename:"Mutation",addMessage:{__typename:"Message",id:Math.random().toString(36).substr(2,9),createdAt:new Date,isMine:!0,chat:{__typename:"Chat",id:a},content:n}},update:function(n,t){var e=t.data.addMessage;xn(n,e)}})},[f,a,h]);if(Object(c.useEffect)(function(){o&&m({variables:{after:o,limit:u},updateQuery:function(n,t){var e=t.fetchMoreResult,a=[].concat(Object(ut.a)(e.chat.messages.messages),Object(ut.a)(n.chat.messages.messages));return Object(ot.a)({},n,{chat:Object(ot.a)({},n.chat,{messages:Object(ot.a)({},e.chat.messages,{messages:a})})})}})},[o,u,m]),void 0===f)return null;var g=f.chat;return b?null:null===g?null:g?i.a.createElement(ee,null,i.a.createElement(Mt,{chat:g,history:e}),g.messages&&i.a.createElement(Yt,{messages:g.messages.messages,hasMore:g.messages.hasMore,loadMore:function(){return l(g.messages.cursor)}}),i.a.createElement(Ut,{onSendMessage:v})):i.a.createElement(d.a,{to:"/chats"})},oe=function(n){var t=n.history,e=n.chatId;return i.a.createElement(ce,null,i.a.createElement(ie,{history:t,chatId:e}))},ue=e(106),le=e.n(ue);function se(){var n=Object(f.a)(["\n  color: var(--primary-text) !important;\n"]);return se=function(){return n},n}function de(){var n=Object(f.a)(["\n  flex: 1;\n"]);return de=function(){return n},n}function fe(){var n=Object(f.a)(["\n  display: flex;\n  background-color: var(--primary-bg);\n  color: var(--primary-text);\n  font-size: 20px;\n  line-height: 40px;\n"]);return fe=function(){return n},n}var be=Object(b.b)(lt.a)(fe()),me=b.b.div(de()),pe=Object(b.b)(Sn.a)(se()),he=function(n){var t=n.history,e=In(),a=Object(c.useCallback)(function(){e().then(function(){t.replace("/sign-in")})},[t,e]);return i.a.createElement(be,null,i.a.createElement(me,null,"Whatsapp Clone"),i.a.createElement(pe,{"data-testid":"sign-out-button",onClick:a},i.a.createElement(le.a,null)))},ve=e(202),ge=e(205);function je(){var n=Object(f.a)(["\n  position: absolute;\n  color: gray;\n  top: 20px;\n  right: 0;\n  font-size: 13px;\n"]);return je=function(){return n},n}function Oe(){var n=Object(f.a)(["\n  color: gray;\n  font-size: 15px;\n  margin-top: 5px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n"]);return Oe=function(){return n},n}function xe(){var n=Object(f.a)(["\n  margin-top: 5px;\n"]);return xe=function(){return n},n}function ye(){var n=Object(f.a)(["\n  width: calc(100% - 60px);\n  height: 46px;\n  padding: 15px 0;\n  margin-left: 10px;\n  border-bottom: 0.5px solid silver;\n  position: relative;\n"]);return ye=function(){return n},n}function Ee(){var n=Object(f.a)(["\n  height: 50px;\n  width: 50px;\n  object-fit: cover;\n  border-radius: 50%;\n"]);return Ee=function(){return n},n}function we(){var n=Object(f.a)(["\n  height: 76px;\n  padding: 0 15px;\n  display: flex;\n"]);return we=function(){return n},n}function Ce(){var n=Object(f.a)(["\n  padding: 0 !important;\n"]);return Ce=function(){return n},n}function ke(){var n=Object(f.a)(["\n  height: calc(100% - 56px);\n  overflow-y: overlay;\n"]);return ke=function(){return n},n}var Me=b.b.div(ke()),Ie=Object(b.b)(ve.a)(Ce()),$e=Object(b.b)(ge.a)(we()),Se=b.b.img(Ee()),Ae=b.b.div(ye()),qe=b.b.div(xe()),De=b.b.div(Oe()),Fe=b.b.div(je()),Re=function(n){var t,e=n.history,a=Object(c.useCallback)(function(n){e.push("chats/".concat(n.id))},[e]),r=function(){var n=Object(l.b)(),t=re(),e=t.limit,a=t.after;return function(t){n.query({query:X,variables:{chatId:t,after:a,limit:e}})}}(),o=w.a(Z,t).data;if(void 0===o||void 0===o.chats)return null;var u=o.chats;return i.a.createElement(Me,null,i.a.createElement(Ie,null,u.map(function(n){return i.a.createElement($e,{key:n.id,"data-testid":"chat",button:!0,onClick:a.bind(null,n),onMouseEnter:function(){r(n.id)}},i.a.createElement(Se,{"data-testid":"picture",src:n.picture,alt:"Profile"}),i.a.createElement(Ae,null,i.a.createElement(qe,{"data-testid":"name"},n.name),n.lastMessage&&i.a.createElement(i.a.Fragment,null,i.a.createElement(De,{"data-testid":"content"},n.lastMessage.content),i.a.createElement(Fe,{"data-testid":"date"},zt()(n.lastMessage.createdAt,"HH:mm")))))})))},Ue=e(107),_e=e.n(Ue);function ze(){var n=Object(f.a)(["\n  query UsersList {\n    users {\n      ...User\n    }\n  }\n  ","\n"]);return ze=function(){return n},n}function Ne(){var n=Object(f.a)(["\n  padding-left: 15px;\n  font-weight: bold;\n"]);return Ne=function(){return n},n}function Le(){var n=Object(f.a)(["\n  height: 50px;\n  width: 50px;\n  object-fit: cover;\n  border-radius: 50%;\n"]);return Le=function(){return n},n}function Pe(){var n=Object(f.a)(["\n  position: relative;\n  padding: 7.5px 15px;\n  display: flex;\n  cursor: pinter;\n"]);return Pe=function(){return n},n}function He(){var n=Object(f.a)(["\n  padding: 0;\n"]);return He=function(){return n},n}var Qe=Object(b.b)(ve.a)(He()),Te=Object(b.b)(ge.a)(Pe()),We=b.b.img(Le()),Be=b.b.div(Ne()),Ge=(y()(ze(),vn),function(n){var t,e=n.onUserPick,a=void 0===e?function(n){}:e,r=w.a(Y,t),c=r.data,o=r.loading;if(void 0===c)return null;var u=c.users;return i.a.createElement(Qe,null,!o&&u.map(function(n){return i.a.createElement(Te,{key:n.id,"data-testid":"user",onClick:a.bind(null,n),button:!0},null!==n&&null!==n.picture&&i.a.createElement(i.a.Fragment,null,i.a.createElement(We,{"data-testid":"picture",src:n.picture}),i.a.createElement(Be,{"data-testid":"name"},n.name)))}))});function Je(){var n=Object(f.a)(["\n  position: fixed;\n  right: 10px;\n  bottom: 10px;\n\n  button {\n    min-width: 50px;\n    width: 50px;\n    height: 50px;\n    border-radius: 999px;\n    background-color: var(--secondary-bg);\n    color: white;\n  }\n"]);return Je=function(){return n},n}var Ke=b.b.div(Je()),Xe=function(n){var t=n.history,e=function(){var n=Object(l.b)();return function(){n.query({query:Y})}}();return i.a.createElement(Ke,{onMouseEnter:function(){return e()}},i.a.createElement(Sn.a,{"data-testid":"new-chat-button",variant:"contained",color:"secondary",onClick:function(){t.push("/new-chat")}},i.a.createElement(_e.a,null)))};function Ve(){var n=Object(f.a)(["\n  height: 100vh;\n"]);return Ve=function(){return n},n}var Ye=b.b.div(Ve()),Ze=function(n){var t=n.history;return i.a.createElement(Ye,null,i.a.createElement(he,{history:t}),i.a.createElement(Re,{history:t}),i.a.createElement(Xe,{history:t}))};function na(){var n=Object(f.a)(["\n  flex: 1;\n"]);return na=function(){return n},n}function ta(){var n=Object(f.a)(["\n  svg {\n    color: var(--primary-text);\n  }\n"]);return ta=function(){return n},n}function ea(){var n=Object(f.a)(["\n  display: flex;\n  background-color: var(--primary-bg);\n  color: var(--primary-text);\n  font-size: 20px;\n  line-height: 40px;\n"]);return ea=function(){return n},n}var aa=Object(b.b)(lt.a)(ea()),ra=Object(b.b)(Sn.a)(ta()),ca=b.b.div(na()),ia=function(n){var t=n.history,e=Object(c.useCallback)(function(){t.replace("/chats")},[t]);return i.a.createElement(aa,null,i.a.createElement(ra,{"data-testid":"back-button",onClick:e},i.a.createElement(dt.a,null)),i.a.createElement(ca,null,"Create Chat"))};function oa(){var n=Object(f.a)(["\n  mutation AddChat($recipientId: ID!) {\n    addChat(recipientId: $recipientId) {\n      ...Chat\n    }\n  }\n  ","\n"]);return oa=function(){return n},n}function ua(){var n=Object(f.a)(["\n  height: calc(100% - 56px);\n"]);return ua=function(){return n},n}function la(){var n=Object(f.a)(["\n  height: calc(100% - 56px);\n  overflow-y: overlay;\n"]);return la=function(){return n},n}b.b.div(la()),Object(b.b)(Ge)(ua());y()(oa(),dn);var sa=function(n){var t,e=n.history,a=(t={update:function(n,t){var e=t.data.addChat;yn(n,e)}},E.a(J,t)),r=Object(O.a)(a,1)[0],o=Object(c.useCallback)(function(n){r({optimisticResponse:{__typename:"Mutation",addChat:{__typename:"Chat",id:Math.random().toString(36).substr(2,9),name:n.name,picture:n.picture,lastMessage:null}},variables:{recipientId:n.id}}).then(function(n){var t=n.data;null!==t&&e.push("/chats/".concat(t.addChat.id))})},[r,e]);return i.a.createElement("div",null,i.a.createElement(ia,{history:e}),i.a.createElement(Ge,{onUserPick:o}))},da=function(){return i.a.createElement(d.a,{to:"/chats"})},fa=function(){return i.a.createElement(s.a,null,i.a.createElement(j,null,i.a.createElement(d.b,{exact:!0,path:"/sign-(in|up)",component:it}),i.a.createElement(d.b,{exact:!0,path:"/chats",component:Cn(Ze)}),i.a.createElement(d.b,{exact:!0,path:"/chats/:chatId",component:Cn(function(n){var t=n.match,e=n.history;return i.a.createElement(oe,{chatId:t.params.chatId,history:e})})}),i.a.createElement(d.b,{exact:!0,path:"/new-chat",component:Cn(sa)})),i.a.createElement(d.b,{exact:!0,path:"/",render:da}))},ba=e(46),ma=e(3),pa=e(112),ha=e(108),va=e(23),ga="http://localhost:4000/graphql",ja=ga.replace(/^https?/,"ws"),Oa=new pa.a({uri:ga,credentials:"include"}),xa=new ha.a({uri:ja,options:{reconnect:!0}}),ya=Object(va.d)(function(n){var t=n.query,e=Object(ma.l)(t),a=e.kind,r=e.operation;return"OperationDefinition"===a&&"subscription"===r},xa,Oa),Ea=va.a.from([ya]),wa=new on.a,Ca=new ba.a({link:Ea,cache:wa});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ka=Object(a.a)({palette:{primary:{main:"#2c6157"},secondary:{main:"#6fd056"}}});u.a.render(i.a.createElement(r.a,{theme:ka},i.a.createElement(l.a,{client:Ca},i.a.createElement(fa,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(n){n.unregister()})}},[[118,1,2]]]);
//# sourceMappingURL=main.557ef859.chunk.js.map